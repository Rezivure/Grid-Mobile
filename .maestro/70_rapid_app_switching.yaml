appId: app.mygrid.grid
---

# Start with fresh login
- runFlow: flows/login_testuser1.yaml


# Ensure app is running and logged in
- launchApp
- waitForAnimationToEnd
- assertVisible: "Map"

# Set up a friend with location for stability testing
- runScript:
    script: |
      cd .maestro/helpers
      ./api_login.sh testuser2 testpass123
      ./api_send_friend_request.sh testuser2 testuser1
      ./api_send_location.sh testuser2 40.7580 -73.9855

# Wait for location to appear
- waitForAnimationToEnd
- assertVisible: "testuser2"

# Rapid switching sequence - 5 cycles
- stopApp
- wait: 500
- launchApp
- waitForAnimationToEnd
- assertVisible: "Map"

- stopApp  
- wait: 500
- launchApp
- waitForAnimationToEnd
- assertVisible: "Map"

- stopApp
- wait: 500  
- launchApp
- waitForAnimationToEnd
- assertVisible: "Map"

- stopApp
- wait: 500
- launchApp
- waitForAnimationToEnd
- assertVisible: "Map"

- stopApp
- wait: 500
- launchApp
- waitForAnimationToEnd

# Verify app is still stable and functional
- assertVisible: "Map"
- assertVisible: "testuser2"

# Test navigation to ensure app is still responsive
- tapOn: "Settings"
- assertVisible: "Display Name"
- tapOn: "Back"
- assertVisible: "Map"

# Test map interaction
- tapOn:
    point: "50%,50%"
- wait: 500
- assertVisible: "Map"
