appId: app.mygrid.grid
---
# Reusable login flow for testuser1
# Gets the app from fresh state to logged in on map screen

- clearState
- launchApp
- tapOn: "Custom Provider"

# Fill in local server
- scrollUntilVisible:
    element: "Homeserver URL"
    direction: DOWN
- tapOn: "Homeserver URL"
- inputText: "http://localhost:8008"

# Username  
- scrollUntilVisible:
    element: "Username"
    direction: DOWN
- tapOn: "Username"
- inputText: "testuser1"

# Password
- scrollUntilVisible:
    element: "Password"
    direction: DOWN
- tapOn: "Password"
- inputText: "testpass123"

# Sign in
- scrollUntilVisible:
    element: "Sign In"
    direction: DOWN
- tapOn: "Sign In"

# Handle onboarding flow - try to get through it
- tapOn:
    text: "I Understand, Continue"
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "Next"
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "Next" 
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "Next"
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "Get Started"
    optional: true
- waitForAnimationToEnd

# Try to skip past any permission or welcome screens
- tapOn:
    text: "Continue"
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "Allow"
    optional: true
- waitForAnimationToEnd

- tapOn:
    text: "OK"
    optional: true
- waitForAnimationToEnd

# We should eventually reach the map
- assertVisible: "Map"